<h2>Data Preprocessing</h2>

<p>In order to prepare the datasets for analysis and integration, we carried out a series of preprocessing steps involving cleaning, filtering, transformation, and standardization across the five primary sources used: <strong>S2ID (disaster data)</strong>, <strong>INMET (meteorological data)</strong>, <strong>MapBiomas (land use/land cover)</strong>, <strong>IBGE (demographics)</strong>, and <strong>geospatial shapefiles for municipalities and states</strong>.</p>

<h3>1. S2ID – Disasters and Impact Data</h3>
<ul>
  <li>The original CSV presented encoding issues and irregular line formats. It was cleaned using Python to remove malformed rows and detect the correct header (fifth line).</li>
  <li>Non-numeric values (e.g., decimal commas) were standardized.</li>
  <li>Columns were renamed and harmonized, e.g., converting "Município" to lowercase and normalizing whitespace.</li>
  <li>We filtered for <strong>hydrological disasters</strong> only (floods, flash floods, etc.) using COBRADE classification and date filters (only 2024).</li>
  <li>A new column was created aggregating all affected populations: deaths, displaced, injured, homeless, etc.</li>
</ul>

<h3>2. INMET – Rainfall Data</h3>
<ul>
  <li>Over 500 CSVs, one per weather station, were batch-processed using KNIME with a loop structure and dynamic file reading.</li>
  <li>Metadata (station name, coordinates, state) was extracted separately using Python and merged back with rainfall values.</li>
  <li>All precipitation values were cleaned and standardized to use dots as decimal separators.</li>
  <li>Dates were converted to proper <code>Local Date</code> format and monthly aggregation was performed.</li>
  <li>Meteorological stations were geolocated and assigned to <strong>municipalities</strong> using shapefiles and spatial joins.</li>
</ul>

<h3>3. MapBiomas – Land Use and Urban Risk</h3>
<ul>
  <li>Two main sources were used: Excel files from the platform and CSV from Google Earth Engine.</li>
  <li>Only relevant sheets (second sheet) were extracted using <code>pandas</code> and cleaned.</li>
  <li>Rows corresponding to <strong>urban areas (code 4.2)</strong> and <strong>forest areas</strong> were filtered.</li>
  <li>Indicators were created to calculate the <strong>percentage increase</strong> in urban area between 2013 and 2023 and decrease in forest area.</li>
  <li>For urban risk areas (GeoJSON polygons), we used spatial intersection to calculate total km² of risk areas per municipality.</li>
</ul>

<h3>4. IBGE – Population Data</h3>
<ul>
  <li>Although the dataset is from 2018, it was used to normalize indicators (e.g., affected people per 1000 residents).</li>
  <li>Data was joined based on municipality names, which required normalization to avoid mismatches (removing accents, trimming whitespace).</li>
</ul>

<h3>5. Data Integration</h3>
<ul>
  <li>Datasets were joined primarily using <strong>municipality name + state</strong>. To avoid inconsistencies due to duplicated names across states, names were normalized and matched cautiously.</li>
  <li>Final datasets contain one row per municipality with integrated attributes: rainfall volume, area at risk, population affected, urban expansion, etc.</li>
</ul>